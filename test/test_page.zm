
color shape_colors [..] = {
    color:red,
    color:blue,
    color:yellow,
    color:black,
    color:magnenta,
    color:aqua,
    color:white,
    color:green
}

Page testpage
{

    TestItem item;

    // This timer is started at the beginning of a trial if it is fired
    // the trial ends because of maximum trial duration is called.
    Timer max_trial_dur_timer {

        on_event:expire()
        {

        }

    }
    
    // Pressing the left button on the button box starts this timer
    // if the timer expires the trial will be aborted.
    Timer abort_trial_timer{

        on_event:expire()
        {
        }

    }

    Response response
    {
        bool    is_looking;
        time    lookstart;
        time    nolookstart;
        dur     cumlt;
        dur     cumnlt;

        on_event:start()
        {
            clear();
            lookstart = event_time;
            // assume the child is looking.
            is_looking = true;
        }

        void clear()
        {
            lookstart   = 0;
            nolookstart = 0;
            cumlt       = 0ms;
            cumnlt      = 0ms;
            is_looking = true;
        }

        void process_hit(time t, HvfEvent event)
        {
            HitType validity = hit(t);
            if (validity == HIT_VALID) {
                if (event == EVENT_START) { // start abort timer
                    is_looking = false;
                    nolookstart = t;
                    cumlt += (t - lookstart)
                }
                else if (event == EVENT_STOP) {
                    is_looking = false;
                    nolookstart = t;
                    cumlt += (t - lookstart)
                }
            }
        }
    }

    VerticalLayout layout
    {
        on_event:init()
        {
            spacing = 50;
            height = 0;
            is_visible = true;
        }

        Canvas canvas
        {
            double max_radius;

            on_event:init()
            {
                width = 800;
                height= 800;

                offset_x = width/2;
                offset_y = height/2;

                max_radius =
                    canvas.width < canvas.height : canvas.width ? canvas.height;
                //Hide the canvas frame
                fill_pattern_color = TEST_PAGE_COLOR;

                // This puts the bullseye in a frame
                //fill_pattern_color = TEST_PAGE_STIMULUS_COLOR;
            }

            // Make circle shapes that get smaller and smaller.
            CirkelShape c0
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 0;
                fill_pattern_color = colors[0];
            }
            CirkelShape c1
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 1;
                fill_pattern_color = colors[1];
            }
            CirkelShape c2
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 2;
                fill_pattern_color = colors[2];
            }
            CirkelShape c3
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 3;
                fill_pattern_color = colors[3];
            }
            CirkelShape c4
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 4;
                fill_pattern_color = colors[4];
            }
            CirkelShape c5
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 5;
                fill_pattern_color = colors[5];
            }
            CirkelShape c6
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 6;
                fill_pattern_color = colors[6];
            }
            CirkelShape c7
            {
                x = 0;
                y = 0;
                radius = max_radius - max_radius / 8 * 7;
                fill_pattern_color = colors[7];
            }
        }
    }

    time action(time start, bool shuffle_colors=false)
    {
        time tref = test_windows1.show_test_page(this, start);
        return tref;
    }
}
